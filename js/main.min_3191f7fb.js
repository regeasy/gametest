var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(o,n){function s(e){try{h(i.next(e))}catch(t){n(t)}}function a(e){try{h(i["throw"](e))}catch(t){n(t)}}function h(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}h((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return i([e,t])}}function i(r){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,n&&(s=n[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(n,r[1])).done)return s;switch(n=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return h.label++,{value:r[1],done:!1};case 5:h.label++,n=r[1],r=[0];continue;case 7:r=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){h=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){h.label=r[1];break}if(6===r[0]&&h.label<s[1]){h.label=s[1],s=r;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(r);break}s[2]&&h.ops.pop(),h.trys.pop();continue}r=t.call(e,h)}catch(i){r=[6,i],n=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,n,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},TimerContainer=function(){function e(){}return e}();__reflect(TimerContainer.prototype,"TimerContainer");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.text="fuck"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),!window.platform,window.platform=new DebugPlatform;var Socket=function(){function e(){}return e.init=function(e,t){this.webSocket=new egret.WebSocket,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveData,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onConnected,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onConnectClose,this),this.webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this.webSocket.connectByUrl(e+"/"+t)},e.register=function(e){if(this.socketReceiveList.some(function(t){return e.module==t.module}))throw"module is exist";this.socketReceiveList.push(e)},e.writeOff=function(e){for(var t=0;t<=this.socketReceiveList.length;t++){var r=this.socketReceiveList[t];if(r.module==e){this.socketReceiveList.splice(t,1);break}}},e.send=function(e){this.webSocket.writeUTF(this.UUID+JSON.stringify(e))},e.onReceiveData=function(e){var t=this.webSocket.readUTF();if(console.log("onReceiveData:",t),0!=t.length)for(var r=JSON.parse(t),i=0,o=this.socketReceiveList;i<o.length;i++){var n=o[i];n.module==r.module&&n.receive(r.code,r.data)}},e.onConnected=function(){console.log("webSocket","connect success")},e.onConnectClose=function(){console.log("webSocket","connect closed")},e.onIOError=function(){console.log("webSocket","IO Error")},e.socketReceiveList=[],e}();__reflect(Socket.prototype,"Socket");var SocketMiddWare=function(){function e(e){this.route=e}return e.prototype.middWare=function(e){console.log("data:",e),this.cb(e)},e.prototype.setCb=function(e){this.cb=e},e}();__reflect(SocketMiddWare.prototype,"SocketMiddWare");var SpiderContainer=function(e){function t(t,r){var i=e.call(this)||this;return i.layout=RES.getRes("layout_json").layout,i.x=0,i.y=100,i.width=900,i.height=400,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){for(var r=0;r<e.length;r++){var i=new Puker(e[r],t+(r+1)*this.layout.pukerBigSpace,20,this.layout.pukerBigWidth,this.layout.pukerBigHeight);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pukerStartMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.pukerStopMove,this),this.addChild(i)}},t.prototype.pukerStartMove=function(t){this.draggedObject=t.currentTarget,this.offsetX=t.stageX-this.draggedObject.x,this.offsetY=t.stageY-this.draggedObject.y,this.addChild(this.draggedObject),console.log("dd:",e.prototype.getChildIndex.call(this,this.draggedObject)),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.pukerMove,this)},t.prototype.pukerMove=function(e){this.draggedObject.x=e.stageX-this.offsetX,this.draggedObject.y=e.stageY-this.offsetY},t.prototype.pukerStopMove=function(e){console.log("pukerClick: y:",this.draggedObject.y,this.draggedObject.name),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.pukerMove,this)},t}(egret.DisplayObjectContainer);__reflect(SpiderContainer.prototype,"SpiderContainer");var TextOtherContainer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").textOtherContainer;return r?i.x=o.leftX:i.x=o.rightX,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=0;t||(r=16+64*(6-e.length));var i=new TextTip(e,r,0,64);this.addChild(i)},t}(egret.DisplayObjectContainer);__reflect(TextOtherContainer.prototype,"TextOtherContainer");var OtherPukerCountContains=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").otherPukerCountContainer;r?i.x=o.leftX:i.x=o.rightX,i.y=o.y,i.width=o.width,i.height=o.height;var n=new TextTip(t+"",0,100,32);return n.width=100,i.addChild(n),i}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(OtherPukerCountContains.prototype,"OtherPukerCountContains");var BottomContainer=function(e){function t(t){var r,i=e.call(this)||this;0===t?(r=RES.getRes("layout_json").hallBottomContainer,i.showHallBottom()):(r=RES.getRes("layout_json").bottomContainer,i.showRoomBottom()),i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height;var o=new egret.Shape;return o.graphics.beginFill(12565659),o.graphics.drawRect(0,0,i.width,i.height),o.graphics.endFill(),i.addChild(o),i}return __extends(t,e),t.prototype.showHallBottom=function(){},t.prototype.showRoomBottom=function(){var e=new TextTip("贝壳：3000",40,6,32);this.addChild(e);var t=new TextTip("铜板：200",300,6,32);this.addChild(t);var r=new TextTip("宠物头像   宠物技能",600,6,32);this.addChild(r)},t}(egret.DisplayObjectContainer);__reflect(BottomContainer.prototype,"BottomContainer");var GameResultContainer=function(e){function t(t){var r=e.call(this)||this,i=RES.getRes("layout_json").layout;r.x=0,r.y=0,r.width=i.stageWidth,r.height=i.stageHeight;var o=new egret.Shape;return o.graphics.beginFill(1122867),o.graphics.drawRect(0,0,r.width,r.height),o.graphics.endFill(),o.alpha=.3,r.addChild(o),r.show(t),r}return __extends(t,e),t.prototype.show=function(e){var t;t=e?new TextTip("胜利",800,700,128):new TextTip("失败",800,700,128),this.addChild(t)},t}(egret.DisplayObjectContainer);__reflect(GameResultContainer.prototype,"GameResultContainer");var HallMenuContainer=function(e){function t(t,r){var i=e.call(this)||this;return i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=new HallMenus("menu_setting_png",40,40,160,160);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuSettingClick,t),this.addChild(r);var i=new HallMenus("menu_activity_png",40,220,160,160);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuActivityClick,t),this.addChild(i);var o=new HallMenus("menu_customerServer_png",40,400,160,160);o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuCustomerServerClick,t),this.addChild(o);var n=new HallMenus("menu_home_png",1720,40,160,160);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuHomeClick,t),this.addChild(n);var s=new HallMenus("menu_messages_png",1720,220,160,160);s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuMessagesClick,t),this.addChild(s);var a=new HallMenus("menu_friends_png",1720,400,160,160);a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuFriendsClick,t),this.addChild(a);var h=new HallMenus("menu_shop_png",1280,900,160,160);h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuShopClick,t),this.addChild(h);var l=new HallMenus("menu_package_png",1500,900,160,160);l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuPackageClick,t),this.addChild(l);var u=new HallMenus("menu_pet_png",1720,900,160,160);u.touchEnabled=!0,u.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuPetClick,t),this.addChild(u);var d=new HallMenus("menu_offlineMode_png",400,200,300,520);d.touchEnabled=!0,d.addEventListener(egret.TouchEvent.TOUCH_TAP,t.menuOfflineModeClick,t),this.addChild(d);var p=new HallMenus("menu_classicMode_png",810,200,300,520);p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,t.menuClassicModeClick,t),this.addChild(p);var c=new HallMenus("menu_friendMode_png",1210,200,300,520);c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_TAP,t.menuFriendModeClick,t),this.addChild(c)},t.prototype.menuSettingClick=function(){console.log("menuSettingClick---")},t.prototype.menuActivityClick=function(){console.log("menuActivityClick---")},t.prototype.menuCustomerServerClick=function(){console.log("menuCustomerServerClick---")},t.prototype.menuHomeClick=function(){console.log("menuHomeClick---")},t.prototype.menuMessagesClick=function(){console.log("menuMessagesClick---")},t.prototype.menuFriendsClick=function(){console.log("menuFriendsClick---")},t.prototype.menuShopClick=function(){console.log("menuShopClick---");var e=new Shop;this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.menuPackageClick=function(){console.log("menuPackageClick---")},t.prototype.menuPetClick=function(){console.log("menuPetClick---")},t}(egret.DisplayObjectContainer);__reflect(HallMenuContainer.prototype,"HallMenuContainer");var PlayerButtonContainer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").playerButtonContainer;return i.x=o.x,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){if(t==RoomManager.ButtonsCallTheLandlord){var r=new Button("nocall",150,0,300,200);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuJiao,e),this.addChild(r);var i=new Button("call",550,0,300,200);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonJiaoDiZhu,e),this.addChild(i)}else if(t==RoomManager.ButtonsFight4TheLandlord){var r=new Button("pass",250,0,200,50);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuQiang,e),this.addChild(r);var o=new TextTip("不抢",286,6,64);this.addChild(o);var i=new Button("ok",550,0,200,50);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonQiangDiZhu,e),this.addChild(i);var n=new TextTip("抢地主",554,6,64);this.addChild(n)}else if(t==RoomManager.ButtonsDiscard){var s=new Button("pass",25,0,300,200);s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuYao,e),this.addChild(s);var r=new Button("tip",350,0,300,200);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonTiShi,e),this.addChild(r);var i=new Button("ok",675,0,300,200);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonChuPai,e),this.addChild(i)}else if(t==RoomManager.ButtonsGameOver){var a=new Button("leaveRoom",250,0,300,200);a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,e.button_gameOver,e),this.addChild(a);var h=new Button("newGame",550,0,300,200);h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,e.button_restart,e),this.addChild(h)}},t}(egret.DisplayObjectContainer);__reflect(PlayerButtonContainer.prototype,"PlayerButtonContainer");var TopContainer=function(e){function t(){var t=e.call(this)||this,r=RES.getRes("layout_json").topContainer;t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height;var i=new egret.Shape;return i.graphics.beginFill(11648477),i.graphics.drawRect(0,0,t.width,t.height),i.graphics.endFill(),t.addChild(i),t.show(),t}return __extends(t,e),t.prototype.show=function(){var e=new TextTip("贝壳：3000",40,6,32);this.addChild(e);var t=new TextTip("铜板：200",300,6,32);this.addChild(t);var r=new TextTip("宠物头像   宠物技能",600,6,32);this.addChild(r)},t}(egret.DisplayObjectContainer);__reflect(TopContainer.prototype,"TopContainer");var PortraitContainer=function(e){function t(t,r,i){var o=e.call(this)||this,n=RES.getRes("layout_json").portraitContainer;o.x=n.x,o.y=n.y,o.width=n.width,o.height=n.height;var s=new TextTip(t.getName(),0,100,16);if(s.width=100,o.addChild(s),i){var a=new TextTip("地主",100,0,32);a.width=100,o.addChild(a)}return o.show(t.getSex(),r),o}return __extends(t,e),t.prototype.show=function(e,t){var r=new DefaultPortrait(e,t,0,0,100,100);this.addChild(r)},t}(egret.DisplayObjectContainer);__reflect(PortraitContainer.prototype,"PortraitContainer");var PortraitOtherContainer=function(e){function t(t,r,i,o){var n=e.call(this)||this,s=RES.getRes("layout_json").portraitOtherContainer;i?n.x=s.leftX:n.x=s.rightX,n.y=s.y,n.width=s.width,n.height=s.height;var a=new TextTip(t.getName(),0,100,16);if(a.width=100,n.addChild(a),o){var h=new TextTip("地主",0,-50,32);h.width=100,n.addChild(h)}return n.show(t,r),n}return __extends(t,e),t.prototype.show=function(e,t){var r=new DefaultPortrait(e.getSex(),t,0,0,100,100);this.addChild(r)},t}(egret.DisplayObjectContainer);__reflect(PortraitOtherContainer.prototype,"PortraitOtherContainer");var PukerBottomContainer=function(e){function t(t){var r=e.call(this)||this,i=RES.getRes("layout_json").pukerBottomContainer;return r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height,r.show(t),r}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=0,i=0;i<e.length;i++){var o=new Puker(e[i],r+i*t.pukerSmallSpace,0,t.pukerSmallWidth,t.pukerSmallHeight);this.addChild(o)}},t}(egret.DisplayObjectContainer);__reflect(PukerBottomContainer.prototype,"PukerBottomContainer");var PukerContainer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").pukerContainer;return i.x=o.x,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){for(var r=RES.getRes("layout_json").puker,i=.5*(20-t.length)*r.pukerSpace,o=0;o<t.length;o++){var n=new Puker(t[o],i+o*r.pukerSpace,r.pukerUpMove,r.pukerWidth,r.pukerHeight);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,e.pukerClick,e),this.addChild(n)}},t.prototype.removePukerByNames=function(e){for(var t=0;t<e.length;t++)null!=this.getChildByName(e[t]+"")&&this.removeChild(this.getChildByName(e[t]+""))},t}(egret.DisplayObjectContainer);__reflect(PukerContainer.prototype,"PukerContainer");var PukerOtherContainer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").pukerOtherContainer;return r?i.x=o.leftX:i.x=o.rightX,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=RES.getRes("layout_json").puker,i=0;t||(i=(20-e.length)*r.pukerSmallSpace);for(var o=0;o<e.length;o++){var n=new Puker(e[o],i+o*r.pukerSmallSpace,0,r.pukerSmallWidth,r.pukerSmallHeight);this.addChild(n)}},t}(egret.DisplayObjectContainer);__reflect(PukerOtherContainer.prototype,"PukerOtherContainer");var PukerPlayContainer=function(e){function t(t){var r=e.call(this)||this,i=RES.getRes("layout_json").pukerPlayerContainer;return r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height,r.show(t),r}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=.5*(20-e.length)*t.pukerPlaySpace,i=0;i<e.length;i++){var o=new Puker(e[i],r+i*t.pukerPlaySpace,0,t.pukerPlayWidth,t.pukerPlayHeight);this.addChild(o)}},t}(egret.DisplayObjectContainer);__reflect(PukerPlayContainer.prototype,"PukerPlayContainer");var PukerVerticalContainer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").pukerVerticalContainer;return r?i.x=o.leftX:i.x=o.rightX,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t),i}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=0,i=0,o=0;o<e.length;o++){o>=10&&(i=40),r>=10&&(r-=10);var n=new Puker(e[o],r*t.pukerSmallSpace,i,t.pukerSmallWidth,t.pukerSmallHeight);r++,this.addChild(n)}},t.prototype.show1=function(e){for(var t=RES.getRes("layout_json").puker,r=0,i=0,o=0;o<e.length;o++){o>=10&&(r=.3*t.pukerSmallHeight),i>=10&&(i-=10);var n=new Puker(e[o],r,i*t.pukerSmallSpace,t.pukerSmallWidth,t.pukerSmallHeight);i++,this.addChild(n)}},t}(egret.DisplayObjectContainer);__reflect(PukerVerticalContainer.prototype,"PukerVerticalContainer");var CommodityContainer=function(e){function t(t,r,i){var o=e.call(this)||this;return o.x=r,o.y=i,o.width=360,o.height=600,o.commodityNumber=t.initNumber,o.minNumber=t.minNumber,o.price=t.price,o.commodityName=t.name,o.commodityDescribe=t.describe,o.totalCurrency=o.commodityNumber*o.price,o.show(t.imgUrl),o}return __extends(t,e),t.prototype.show=function(e){var t=new HallMenus("shop_bgImg_png",0,0,this.width,this.height);this.addChild(t);var r=new HallMenus(e,130,50,100,100);this.addChild(r);var i=new HallMenus("shop_name_bgImg_png",70,170,220,60);this.addChild(i),this.showName(),this.showDescribe();var o=new HallMenus("shop_button_subtract_png",50,402,36,36);o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.subtractButtonClick,this),this.addChild(o);var n=new HallMenus("shop_input_bgImg_png",108,400,144,40);this.addChild(n),this.showNumber();var s=new HallMenus("shop_button_add_png",270,402,36,36);s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.addButtonClick,this),this.addChild(s);var a=new HallMenus("shop_button_buy_png",80,495,200,50);a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.buyButtonClick,this),this.addChild(a);var h=new HallMenus("currency_copper_png",90,500,40,40);this.addChild(h),this.showTotal()},t.prototype.buyButtonClick=function(){console.log("商品名",this.commodityName,"单价",this.price,"购买数量",this.commodityNumber,"总价",this.totalCurrency,"描述",this.commodityDescribe,"描述文字长度",this.commodityDescribe.length)},t.prototype.showDescribe=function(){null!=this.getChildByName("commodityDescribe")&&this.removeChild(this.getChildByName("commodityDescribe"));var e=new egret.TextField;e.name="commodityDescribe";var t=this.commodityDescribe;t.length>26&&(t=t.substr(0,26)+"..."),e.text="  "+t,e.textColor=2299925,e.size=32,e.fontFamily="KaiTi",e.x=30,e.y=250,e.width=300,this.addChild(e)},t.prototype.showName=function(){null!=this.getChildByName("commodityName")&&this.removeChild(this.getChildByName("commodityName"));var e=new egret.TextField;e.name="commodityName";var t=this.commodityName;t.length>4&&(t=t.substr(0,4)),e.text=t,e.textColor=5855063,e.size=48,e.fontFamily="KaiTi",e.x=180-e.size*e.text.length/2,e.y=176,e.width=300,this.addChild(e)},t.prototype.showNumber=function(){null!=this.getChildByName("commodityNumber")&&this.removeChild(this.getChildByName("commodityNumber"));var e=new egret.TextField;e.name="commodityNumber",e.text=this.commodityNumber+"",e.textColor=16777215,e.size=32,e.x=180-e.size*e.text.length/4,e.y=404,this.addChild(e)},t.prototype.showTotal=function(){null!=this.getChildByName("totalCurrency")&&this.removeChild(this.getChildByName("totalCurrency"));var e=new egret.TextField;e.name="totalCurrency",e.text=this.totalCurrency+"",e.textColor=16777215,e.size=32,e.x=180-e.size*e.text.length/4,e.y=504,this.addChild(e)},t.prototype.subtractButtonClick=function(){this.commodityNumber=this.commodityNumber-this.minNumber,this.commodityNumber<this.minNumber&&(this.commodityNumber=this.minNumber),this.totalCurrency=this.commodityNumber*this.price,this.showNumber(),this.showTotal()},t.prototype.addButtonClick=function(){this.commodityNumber=this.commodityNumber+this.minNumber,this.totalCurrency=this.commodityNumber*this.price,this.showNumber(),this.showTotal()},t.prototype.removeAll=function(){console.log(this.name),this.parent.parent.removeChild(this.parent)},t}(egret.DisplayObjectContainer);__reflect(CommodityContainer.prototype,"CommodityContainer");var ShopContainer=function(e){function t(t){var r=e.call(this)||this;return r.gameShop=[{name:"记牌器",imgUrl:"shop_ssb_png",price:10,initNumber:1,minNumber:1,describe:"可以记录对手所剩的牌，有效期一天"},{name:"保险箱",imgUrl:"shop_nest_png",price:10,initNumber:1,minNumber:1,describe:"可以存放一部分贝壳，存放的贝壳不参与结算，有效期一天"},{name:"超级加倍",imgUrl:"shop_milk_png",price:100,initNumber:1,minNumber:1,describe:"使用后可以使当局倍数乘以4，使用一次后失效"},{name:"先手卡",imgUrl:"shop_egg_png",price:100,initNumber:1,minNumber:1,describe:"使用后可以在不明牌的情况下先手叫地主"}],r.petShop=[{name:"包子",imgUrl:"shop_ssb_png",price:10,initNumber:10,minNumber:10,describe:"宠物幼年时食用包子成长，宠物长大后不再需要"},{name:"牛奶",imgUrl:"shop_milk_png",price:10,initNumber:10,minNumber:10,describe:"宠物消耗的能量只能通过喝牛奶恢复"},{name:"宠物蛋",imgUrl:"shop_egg_png",price:100,initNumber:1,minNumber:1,describe:"宠物蛋会孵化出一个随机宠物，不同的宠物拥有不同的技能"},{name:"宠物窝",imgUrl:"shop_nest_png",price:100,initNumber:1,minNumber:1,describe:"宠物窝用来孵化宠物蛋，一个宠物窝只能孵化一个宠物蛋"}],r.initX=100,r.initY=150,r.initW=360,r.spaceX=100,r.containerName="commodity_",r.x=0,r.y=0,r.width=1920,r.height=1080,r.type=t,r.show(),r}return __extends(t,e),t.prototype.show=function(){var e=new HallMenus("shop_name_bgImg_png",100,50,200,50);e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameButtonClick,this),this.addChild(e),this.showName();var t=new HallMenus("shop_button_buy_png",400,50,200,50);t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.petButtonClick,this),this.addChild(t),this.showCommodity()},t.prototype.showName=function(){var e=new egret.TextField,t="宠物道具";t.length>4&&(t=t.substr(0,4)),e.text=t,e.textColor=5855063,e.size=48,e.fontFamily="KaiTi",e.x=180-e.size*e.text.length/2,e.y=50,e.width=300,this.addChild(e)},t.prototype.gameButtonClick=function(){0!=this.type&&(this.type=0,this.showCommodity())},t.prototype.petButtonClick=function(){1!=this.type&&(this.type=1,this.showCommodity())},t.prototype.showCommodity=function(){var e=this.gameShop,t=this.petShop.length;1===this.type&&(e=this.petShop,t=this.gameShop.length);for(var r=0;t>r;r++){var i=this.containerName+r;null!=this.getChildByName(i)&&this.removeChild(this.getChildByName(i))}for(var r=0;r<e.length&&!(r>=4);r++){var o=this.initX+r*this.initW+r*this.spaceX,n=this.initY,s=new CommodityContainer(e[r],o,n);s.name=this.containerName+r,this.addChild(s)}},t}(egret.DisplayObjectContainer);__reflect(ShopContainer.prototype,"ShopContainer");var OtherPlayingTimer=function(e){function t(t,r){var i=e.call(this)||this,o=RES.getRes("layout_json").otherPlayingTimer;return r?i.x=o.leftX:i.x=o.rightX,i.y=o.y,i.width=o.width,i.height=o.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=new TextTip(e,0,0,48);this.addChild(r)},t}(egret.DisplayObjectContainer);__reflect(OtherPlayingTimer.prototype,"OtherPlayingTimer");var Main=function(e){function t(){var t=e.call(this)||this;return t.user=PukerUtils.getRandomUser(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:return[4,this.loadResource()];case 1:return r.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=r.sent(),[4,platform.login()];case 3:return r.sent(),[4,platform.getUserInfo()];case 4:return t=r.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return r.sent(),[4,RES.loadGroup("preload",1,e)];case 2:return r.sent(),RES.loadGroup("menus",0),console.log("aa   1："),this.stage.removeChild(e),console.log("aa   2："),console.log("aa   3："),[3,4];case 3:return t=r.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){var e=RES.getRes("layout_json").layout;this.stage.orientation=egret.OrientationMode.LANDSCAPE,this.stage.setContentSize(e.stageWidth,e.stageHeight),console.log("舞台大小：",this.stage.stageWidth,"*",this.stage.stageHeight);var t=new StartScene(this.user);t.name="startScene",this.addChild(t)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Button=function(e){function t(t,r,i,o,n){var s=this,a="button_"+t+"_png";return s=e.call(this,RES.getRes(a))||this,s.x=r,s.y=i,s.width=o,s.height=n,s.name=t+r,s}return __extends(t,e),t}(egret.Bitmap);__reflect(Button.prototype,"Button");var DefaultPortrait=function(e){function t(t,r,i,o,n,s){var a=this;"man"!==t&&(t="lady");var h=t+"_"+r+"_png";return a=e.call(this,RES.getRes(h))||this,a.x=i,a.y=o,a.width=n,a.height=s,a.name=r+"",a}return __extends(t,e),t}(egret.Bitmap);__reflect(DefaultPortrait.prototype,"DefaultPortrait");var HallMenus=function(e){function t(t,r,i,o,n){var s=e.call(this,RES.getRes(t))||this;return s.x=r,s.y=i,s.width=o,s.height=n,s.name=t+r+"_"+i,s}return __extends(t,e),t}(egret.Bitmap);__reflect(HallMenus.prototype,"HallMenus");var Layout=function(e){function t(t,r){var i=e.call(this,RES.getRes("gameBgImg_png"))||this;return i.width=t,i.height=r,i}return __extends(t,e),t}(egret.Bitmap);__reflect(Layout.prototype,"Layout");var Puker=function(e){function t(t,r,i,o,n){var s=this,a=t.getId()+"_png";return s=e.call(this,RES.getRes(a))||this,s.x=r,s.y=i,s.width=o,s.height=n,s.name=t.getId()+","+t.getOrderValue(),s}return __extends(t,e),t}(egret.Bitmap);__reflect(Puker.prototype,"Puker");var TextTip=function(e){function t(t,r,i,o){var n=e.call(this)||this;return n.x=r,n.y=i,n.textColor=7833753,n.size=o,n.fontFamily="KaiTi",n.textAlign=egret.HorizontalAlign.CENTER,n.text=t,n}return __extends(t,e),t}(egret.TextField);__reflect(TextTip.prototype,"TextTip");var GameHall=function(e){function t(t){var r=e.call(this)||this;r.topContainer=new TopContainer,r.bottomContainer=new BottomContainer(0),r.menuContainer=new HallMenuContainer(r.user,r),r.user=t,r.width=1920,r.height=1080;var i=new egret.Shape;return i.graphics.beginFill(14671309),i.graphics.drawRect(0,0,r.width,r.height),i.graphics.endFill(),r.addChild(i),r.show(),RES.loadGroup("portraits",4),console.log("portraits load ok"),RES.loadGroup("pokers",3),console.log("pokers load ok"),RES.loadGroup("buttons",2),console.log("buttons load ok"),RES.loadGroup("shops",1),console.log("shops load ok"),r}return __extends(t,e),t.prototype.show=function(){this.topContainer.name="topContainer",this.addChild(this.topContainer),this.bottomContainer.name="bottomContainer",this.addChild(this.bottomContainer),this.menuContainer.name="menuContainer",this.addChild(this.menuContainer)},t.prototype.menuOfflineModeClick=function(){console.log("menuOfflineModeClick---");var e=new StandaloneModel(this.user);this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.menuClassicModeClick=function(){console.log("menuClassicModeClick---");var e=new ClassicModel(this.user);this.parent.addChild(e),this.parent.removeChild(this),this.clearChileByName("menuContainer")},t.prototype.menuFriendModeClick=function(){console.log("menuFriendModeClick---")},t.prototype.clearChileByName=function(e){null!=this.getChildByName(e)&&this.removeChild(this.getChildByName(e))},t.prototype.testHttpRequest=function(){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open("http://127.0.0.1:8800/test",egret.HttpMethod.GET),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},t.prototype.onGetComplete=function(e){var t=e.currentTarget,r=JSON.parse(t.response);console.log("get data : ",r);for(var i=0;i<r.length;i++){var o=new egret.TextField;o.size=18,o.text="房间号："+i+" id:"+r[i].id+"    name:"+r[i].name+"   sort:"+r[i].sort,o.name="responseLabel_"+i,o.width=1e3,o.x=50,o.y=70+20*i,o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.responseLabelClick,this),this.addChild(o),console.log(r[i].id)}},t.prototype.onGetIOError=function(e){console.log("get error : "+e)},t.prototype.onGetProgress=function(e){console.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},t.prototype.responseLabelClick=function(e){var t=e.currentTarget;console.log(t.name)},t}(egret.DisplayObjectContainer);__reflect(GameHall.prototype,"GameHall");var Shop=function(e){function t(){var t=e.call(this)||this;t.bottomContainer=new BottomContainer(1),t.width=1920,t.height=1080;var r=new egret.Shape;return r.graphics.beginFill(14671309),r.graphics.drawRect(0,0,t.width,t.height),r.graphics.endFill(),t.addChild(r),t.show(),t}return __extends(t,e),t.prototype.show=function(){this.bottomContainer.name="bottomContainer",this.addChild(this.bottomContainer);var e=new ShopContainer(0);this.addChild(e)},t}(egret.DisplayObjectContainer);__reflect(Shop.prototype,"Shop");var StartScene=function(e){function t(t){var r=e.call(this)||this;return r.user=t,r.show(),r}return __extends(t,e),t.prototype.show=function(){console.log("舞台大小   1：");var e=new egret.Bitmap(RES.getRes("startBgImg_png"));e.name="bgImg",this.addChild(e),console.log("舞台大小   2：");var t=new egret.Bitmap(RES.getRes("button_begin_png"));t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),t.name="button",t.x=700,t.y=300,this.addChild(t),console.log("舞台大小   3：")},t.prototype.startGame=function(e){console.log("舞台大小   4：");var t=new GameHall(this.user);t.name="gameHall",this.parent.addChild(t),this.parent.removeChild(this),console.log("舞台大小   5：")},t}(egret.DisplayObjectContainer);__reflect(StartScene.prototype,"StartScene");var ClassicModel=function(e){function t(t){var r=e.call(this)||this;r.poc1Index=Math.floor(10*Math.random())+1,r.poc2Index=Math.floor(10*Math.random())+1,r.poc3Index=Math.floor(10*Math.random())+1,r.leftPlayer=PukerUtils.getRandomUser(),r.rightPlayer=PukerUtils.getRandomUser(),r.pokers=new Array,r.activityPokers=new Array,r.activityPlayerSeat=1,r.publicPokers=new Array,r.selectedPokers=new Array,r.user=t,r.layout=RES.getRes("layout_json").layout;var i=new Layout(r.layout.stageWidth,r.layout.stageHeight);r.addChild(i);var o=new TextTip("返回大厅",10,10,64);return o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,r.button_gameOver,r),r.addChild(o),r.show(),r}return __extends(t,e),t.prototype.show=function(){console.log("进入游戏房间"),this.init("ws://118.89.149.21:8800/pokerWebSocket",this.user.getName()),this.showPortrait(!1)},t.prototype.init=function(e,t){this.webSocket=new egret.WebSocket,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveData,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onConnected,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onConnectClose,this),this.webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this.webSocket.connectByUrl(e+"/"+t)
},t.prototype.send=function(e){this.webSocket.writeUTF(JSON.stringify(e)),console.log("消息发送成功",JSON.stringify(e))},t.prototype.onReceiveData=function(e){var t=this.webSocket.readUTF();if(console.log("onReceiveData:",t),0!=t.length){var r=JSON.parse(t);switch(r.code){case RoomManager.Response_InitUserOK:console.log("用户初始化完成","用户Id",r.data.userId),this.user.setId(r.data.userId);var i=new Object,o=new Object;i.code=RoomManager.Request_onRoom,o.userId=this.user.getId(),o.userName=this.user.getName(),i.data=o,this.send(i);break;case RoomManager.Response_RoomInfo:console.log("进入游戏房间成功","房间号",r.data.roomId),this.roomId=r.data.roomId;for(var n=r.data.players,s=0;s<n.length;s++)n[s].id==this.user.getId()&&this.user.setSeat(n[s].seat);for(var s=0;s<n.length;s++)n[s].id!=this.user.getId()&&(this.isLeft(n[s].seat)?(this.leftPlayer.setSeat(n[s].seat),this.leftPlayer.setName(n[s].name)):(this.rightPlayer.setSeat(n[s].seat),this.rightPlayer.setName(n[s].name)),this.showOtherPortrait(n[s].seat,!1));break;case RoomManager.Response_NewPlayerJoin:console.log("有新玩家加入",r.data.player);var a=r.data.player;this.isLeft(a.seat)?(this.leftPlayer.setSeat(a.seat),this.leftPlayer.setName(a.name)):(this.rightPlayer.setSeat(a.seat),this.rightPlayer.setName(a.name)),this.showOtherPortrait(a.seat,!1);break;case RoomManager.Response_Reday:console.log("房间人满，准备开始游戏------------","房间号",r.data.roomId);var i=new Object,o=new Object;i.code=RoomManager.Request_BeReady,o.roomId=r.data.roomId,o.userId=this.user.getId(),i.data=o,this.send(i);break;case RoomManager.Response_DealPoker:console.log("------------发牌---------------"),console.log("我的牌",r.data.pokers);for(var h=r.data.pokers,s=0;s<h.length;s++)this.pokers.push(new Poker(h[s].id,h[s].sort));this.showPokersDynamic();break;case RoomManager.Response_ToCallTheLandlord:break;case RoomManager.Response_LandlordAndLastCard:console.log("------------产生地主---------------"),console.log("底牌",r.data.publicPokers),console.log("地主座位号",r.data.landlordSeat);var l=r.data.landlordSeat;this.landlordSeat=l,this.activityPlayerSeat=l;for(var u=r.data.publicPokers,s=0;s<u.length;s++)this.publicPokers.push(new Poker(u[s].id,u[s].sort));this.showPublicPokers(),this.user.getSeat()==l?(this.user.setLandlord(!0),this.pokers=PukerUtils.sortDescPokers(this.pokers.concat(this.publicPokers)),this.selectedPokers=new Array,this.showPokers(),console.log("------------刷新自己的牌---------------",this.pokers),this.showPortrait(!0),this.showButtons(RoomManager.ButtonsDiscard)):(this.leftPlayer.getSeat()==l?this.leftPlayer.setLandlord(!0):this.rightPlayer.setLandlord(!0),this.showOtherPortrait(l,!0));break;case RoomManager.Response_Discard:console.log("------------有玩家出牌---------------"),console.log("玩家座位号",r.data.seat),console.log("牌",r.data.pokers);var d=r.data.seat,p=r.data.pokers,c=r.data.nextSeat;if(d==this.user.getSeat()){if(null==p||p.length<1)console.log("--------自己未出牌----------");else{this.activityPlayerSeat=d;for(var g=new Array,s=0;s<p.length;s++)g.push(new Poker(p[s].id,p[s].sort));this.activityPokers=g,this.pokers=PukerUtils.removePokers(this.pokers,g),this.showPokers(),this.showPokerPlay()}this.selectedPokers=new Array}else if(null==p||p.length<1)console.log("--------别人未出牌----------"),this.isLeft(d)?(this.clearChileByName("pokerPlayLeft"),this.clearChileByName("textLeft"),this.textLeft=new TextOtherContainer(PukerUtils.getRandomTextTip(),!0),this.textLeft.name="textLeft",this.addChild(this.textLeft)):(this.clearChileByName("pokerPlayRight"),this.clearChileByName("textRight"),this.textRight=new TextOtherContainer(PukerUtils.getRandomTextTip(),!1),this.textRight.name="textRight",this.addChild(this.textRight));else{this.activityPlayerSeat=d;for(var g=new Array,s=0;s<p.length;s++)g.push(new Poker(p[s].id,p[s].sort));this.activityPokers=g,this.isLeft(d)?(this.clearChileByName("pokerPlayLeft"),this.clearChileByName("textLeft"),this.pokerPlayLeft=new PukerOtherContainer(g,!0),this.pokerPlayLeft.name="pokerPlayLeft",this.addChild(this.pokerPlayLeft)):(this.clearChileByName("pokerPlayRight"),this.clearChileByName("textRight"),this.pokerPlayRight=new PukerOtherContainer(g,!1),this.pokerPlayRight.name="pokerPlayLeft",this.addChild(this.pokerPlayRight))}c==this.user.getSeat()&&this.showButtons(RoomManager.ButtonsDiscard);break;case RoomManager.Response_GameOver:console.log("------------游戏结束---------------"),console.log("胜利者",r.data.victory);var y=r.data.victory;y==RoomManager.Victory_Landlord?this.user.getSeat()==this.landlordSeat?(console.log("---------胜利--------"),this.showResult(!0)):(console.log("---------失败--------"),this.showResult(!1)):this.user.getSeat()==this.landlordSeat?(console.log("---------失败--------"),this.showResult(!1)):(console.log("---------胜利--------"),this.showResult(!0));break;default:console.log("onReceiveData:",r.code,r.data)}}},t.prototype.onConnected=function(){console.log("成功连接到服务器-------------")},t.prototype.onConnectClose=function(){console.log("webSocket","connect closed")},t.prototype.onIOError=function(){console.log("webSocket","IO Error")},t.prototype.showPublicPokers=function(){this.publicPokerContainer=new PukerBottomContainer(this.publicPokers),this.publicPokerContainer.name="publicPokerContainer",this.addChild(this.publicPokerContainer)},t.prototype.showPokers=function(){this.clearChileByName("pokerContainer"),this.pokerContainer=new PukerContainer(this,this.pokers),this.pokerContainer.name="pokerContainer",this.addChild(this.pokerContainer)},t.prototype.showPokersDynamic=function(){var e=this;this.pokers=PukerUtils.sortDescPokers(this.pokers);var t=this.pokers.length,r=0,i=new Array;this.createTimer(300,t,function(){console.log("发牌：",r),i.push(e.pokers[r]),e.clearChileByName("pokerContainer"),e.pokerContainer=new PukerContainer(e,i),e.pokerContainer.name="pokerContainer",e.addChild(e.pokerContainer),r++},function(){console.log("发牌结束"),e.showPokers()})},t.prototype.showPokerPlay=function(){this.clearChileByName("pokerPlay"),this.pokerPlay=new PukerPlayContainer(PukerUtils.sortDescPokers(this.selectedPokers)),this.pokerPlay.name="pokerPlay",this.addChild(this.pokerPlay)},t.prototype.clearChileByName=function(e){null!=this.getChildByName(e)&&this.removeChild(this.getChildByName(e))},t.prototype.showPortrait=function(e){this.clearChileByName("portrait"),this.portrait=new PortraitContainer(this.user,7,e),this.portrait.name="portrait",this.addChild(this.portrait)},t.prototype.clearOtherPortrait=function(e){var t;t=this.isLeft(e)?"portraitLeft":"portraitRight",null!=this.getChildByName(t)&&this.removeChild(this.getChildByName(t))},t.prototype.showOtherPortrait=function(e,t){this.clearOtherPortrait(e),this.isLeft(e)?(this.portraitLeft=new PortraitOtherContainer(this.leftPlayer,this.poc3Index,this.isLeft(e),t),this.portraitLeft.name="portraitLeft",this.addChild(this.portraitLeft)):(this.portraitRight=new PortraitOtherContainer(this.rightPlayer,this.poc3Index,this.isLeft(e),t),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight))},t.prototype.isLeft=function(e){return e==this.user.getSeat()+1||e==this.user.getSeat()%3+1?!1:!0},t.prototype.createTimer=function(e,t,r,i){void 0===r&&(r=function(e){}),void 0===i&&(i=function(){});var o=new egret.Timer(e,t);o.addEventListener(egret.TimerEvent.TIMER,r,this),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,i,this),o.start()},t.prototype.button_gameOver=function(){console.log("返回大厅");var e=new GameHall(this.user);e.name="gameHall",this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.button_restart=function(){var e=new StandaloneModel(this.user);this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.showButtons=function(e){this.clearChileByName("pokerPlay"),this.clearChileByName("buttons"),this.buttons=new PlayerButtonContainer(this,e),this.buttons.name="buttons",this.addChild(this.buttons)},t.prototype.buttonChuPai=function(e){if(null==PukerTypeUtils.getType(this.selectedPokers))return void console.log("你这选的是啥呀");if(this.activityPlayerSeat!=this.user.getSeat()&&null!=this.activityPokers&&this.activityPokers.length>0&&!PukerCompareUtils.comparePukers(this.selectedPokers,this.activityPokers))return void console.log("没有上家的牌大");var t=new Object,r=new Object;t.code=RoomManager.Request_Discard,r.roomId=this.roomId,r.userId=this.user.getId();for(var i="",o=0;o<this.selectedPokers.length;o++)i+=this.selectedPokers[o].getId()+",";r.pokers=i,t.data=r,this.send(t),this.clearChileByName("buttons")},t.prototype.buttonBuYao=function(e){if(20==this.pokers.length||this.activityPlayerSeat==this.user.getSeat())return void console.log("-------不能不出-------");var t=new Object,r=new Object;t.code=RoomManager.Request_Discard,r.roomId=this.roomId,r.userId=this.user.getId(),t.data=r,this.send(t),this.clearChileByName("buttons")},t.prototype.buttonTiShi=function(e){},t.prototype.pukerClick=function(e){var t=RES.getRes("layout_json").puker,r=t.pukerUpMove,i=e.currentTarget,o=parseInt(i.name.split(",")[0]),n=parseInt(i.name.split(",")[1]);if(i.y==r)i.y=0,this.selectedPokers.push(new Poker(o,n));else{i.y=r;var s=new Poker(o,n);console.log("poker",s.toString(),"array",this.selectedPokers),this.selectedPokers=PukerUtils.removePokers(this.selectedPokers,[s]),console.log("removedArray",this.selectedPokers)}},t.prototype.showResult=function(e){null!=this.getChildByName("result")&&this.removeChild(this.getChildByName("result"));var t=new GameResultContainer(e);t.name="result",this.addChild(t),console.log("showResult 游戏结束"),this.showButtons(RoomManager.ButtonsGameOver)},t}(egret.DisplayObjectContainer);__reflect(ClassicModel.prototype,"ClassicModel");var FriendModel=function(){function e(){}return e}();__reflect(FriendModel.prototype,"FriendModel");var StandaloneModel=function(e){function t(t){var r=e.call(this)||this;r.isDevelop=!1,r.poc1Index=Math.floor(10*Math.random())+1,r.poc2Index=Math.floor(10*Math.random())+1,r.poc3Index=Math.floor(10*Math.random())+1,r.index=0,r.mySeat=1,r.landlordSeat=1,r.playingSeat=1,r.playedPuker=[],r.playedSeat=1,r.player2=PukerUtils.getRandomUser(),r.player3=PukerUtils.getRandomUser(),r.playerPukers1=new Array,r.playerPukers2=new Array,r.playerPukers3=new Array,r.pukerSelectArray=new Array,r.pokers=PukerUtils.getRandomPokers(),r.pukers1=PukerUtils.sortDescPokers(r.pokers.slice(0,17)),r.pukers2=PukerUtils.sortDescPokers(r.pokers.slice(17,34)),r.pukers3=PukerUtils.sortDescPokers(r.pokers.slice(34,51)),r.pukers4=r.pokers.slice(51),r.user=t,r.layout=RES.getRes("layout_json").layout;var i=new Layout(r.layout.stageWidth,r.layout.stageHeight);r.addChild(i);var o=new TextTip("返回大厅",10,10,64);return o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,r.button_gameOver,r),r.addChild(o),r.show(),r}return __extends(t,e),t.prototype.initPukers=function(){var e=this,t=17,r=new Array,i=0;this.createTimer(300,t,function(){console.log("发牌：",i),r.push(e.pukers1[i]),e.clearPukers(),e.puker=new PukerContainer(e,r),e.puker.name="puker",e.addChild(e.puker),e.showCount(2,i+1),e.showCount(3,i+1),i++},function(){console.log("发牌结束"),e.showButtons(RoomManager.ButtonsCallTheLandlord)})},t.prototype.show=function(){this.initPukers(),this.showCount(2,this.pukers2.length),this.showCount(3,this.pukers3.length),this.isDevelop&&(this.pukerVerticalRight=new PukerVerticalContainer(this.pukers2,!1),this.pukerVerticalRight.name="pukerVerticalRight",this.addChild(this.pukerVerticalRight),this.pukerVerticalLeft=new PukerVerticalContainer(this.pukers3,!0),this.pukerVerticalLeft.name="pukerVerticalLeft",this.addChild(this.pukerVerticalLeft)),this.pukerBottom=new PukerBottomContainer(this.pukers4),this.pukerBottom.name="pukerBottom",this.addChild(this.pukerBottom),this.showPortrait(!1),this.showOtherPortrait(2,!1),this.showOtherPortrait(3,!1),this.bottom=new BottomContainer(1),this.bottom.name="bottom",this.addChild(this.bottom)},t.prototype.buttonChuPai=function(e){return 1==this.playedSeat||PukerCompareUtils.comparePukers(this.pukerSelectArray,this.playedPuker)?null==PukerTypeUtils.getType(this.pukerSelectArray)?void console.log("你这选的是啥呀"):(this.pukers1=PukerUtils.removePokers(this.pukers1,this.pukerSelectArray),console.log("已出牌，剩余牌数",this.pukers1),null!=this.getChildByName("puker")&&this.removeChild(this.getChildByName("puker")),this.puker=new PukerContainer(this,this.pukers1),this.puker.name="puker",this.addChild(this.puker),this.showPukerPlay(),this.playedPuker=PukerUtils.sortDescPokers(this.pukerSelectArray),this.playedSeat=1,this.playingSeat=2,this.autoPlay(),this.pukerSelectArray=new Array,void this.clearButtons()):void console.log("没有上家的牌大,上家座位号：",this.playedSeat)},t.prototype.buttonBuJiao=function(e){console.log("不叫"),this.clearButtons();var t=Math.floor(2*Math.random());0===t?(this.pukers2=PukerUtils.sortDescPokers(this.pukers2.concat(this.pukers4)),this.isDevelop&&this.showPukerVertival(2),this.showCount(2,this.pukers2.length),this.playingSeat=2,this.landlordSeat=2,this.autoPlay(),this.showOtherPortrait(2,!0)):(this.pukers3=PukerUtils.sortDescPokers(this.pukers3.concat(this.pukers4)),this.isDevelop&&this.showPukerVertival(3),this.showCount(3,this.pukers3.length),this.playingSeat=3,this.landlordSeat=3,this.autoPlay(),this.showOtherPortrait(3,!0))},t.prototype.buttonJiaoDiZhu=function(e){console.log("叫地主"),this.pukers1=PukerUtils.sortDescPokers(this.pukers1.concat(this.pukers4)),this.pukerSelectArray=new Array,this.showPukers(),this.showButtons(RoomManager.ButtonsDiscard),this.showPortrait(!0)},t.prototype.buttonBuQiang=function(e){console.log("不抢")},t.prototype.buttonQiangDiZhu=function(e){console.log("抢地主")},t.prototype.buttonBuYao=function(e){1==this.landlordSeat&&20==this.pukers1.length?console.log("地主首张牌",this.pukers1.length):(this.clearButtons(),this.playingSeat=2,this.autoPlay())},t.prototype.buttonTiShi=function(e){console.log(PukerTypeUtils.getType(this.pukerSelectArray))},t.prototype.button_gameOver=function(){console.log("返回大厅");var e=new GameHall(this.user);e.name="gameHall",this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.button_restart=function(){var e=new t(this.user);this.parent.addChild(e),this.parent.removeChild(this)},t.prototype.clearPukerPlay=function(){null!=this.getChildByName("pukerPlay")&&this.removeChild(this.getChildByName("pukerPlay"))},t.prototype.showPukerPlay=function(){this.clearPukerPlay(),this.pukerPlay=new PukerPlayContainer(PukerUtils.sortDescPokers(this.pukerSelectArray)),this.pukerPlay.name="pukerPlay",this.addChild(this.pukerPlay)},t.prototype.showResult=function(e){null!=this.getChildByName("result")&&this.removeChild(this.getChildByName("result"));var t=new GameResultContainer(e);t.name="result",this.addChild(t),console.log("showResult 游戏结束"),this.showButtons(RoomManager.ButtonsGameOver)},t.prototype.gameOver=function(){return null==this.pukers1||0==this.pukers1.length?(this.showResult(!0),!0):null==this.pukers2||0==this.pukers2.length?(3!==this.landlordSeat?this.showResult(!1):this.showResult(!0),!0):null==this.pukers3||0==this.pukers3.length?(2!==this.landlordSeat?this.showResult(!1):this.showResult(!0),!0):!1},t.prototype.autoPlay=function(){var e=this;if(!this.gameOver()&&1!==this.playingSeat){this.clearTextTip(this.playingSeat);var t=Math.floor(5*Math.random())+1,r=15;this.createTimer(1e3,t,function(){e.showOPTimer(r--)},function(){e.clearOPTimer(),e.doAutoPlay()})}},t.prototype.doAutoPlay=function(){if(2===this.playingSeat){if(this.playerPukers2=PukerSeekUtils.autoPlay(this.pukers2,2,this.landlordSeat,this.playedPuker,this.playedSeat),null==this.playerPukers2||0==this.playerPukers2.length)this.showTextTip(this.playingSeat);else if(this.showOtherPuker(2),this.pukers2=PukerUtils.sortDescPokers(PukerUtils.removePokers(this.pukers2,this.playerPukers2)),this.isDevelop&&this.showPukerVertival(2),this.playedPuker=this.playerPukers2,this.playedSeat=2,this.showCount(2,this.pukers2.length),this.gameOver())return;this.playingSeat=3,this.autoPlay()}else if(3===this.playingSeat){if(this.playerPukers3=PukerSeekUtils.autoPlay(this.pukers3,3,this.landlordSeat,this.playedPuker,this.playedSeat),null==this.playerPukers3||0==this.playerPukers3.length)this.showTextTip(this.playingSeat);else if(this.showOtherPuker(3),this.pukers3=PukerUtils.sortDescPokers(PukerUtils.removePokers(this.pukers3,this.playerPukers3)),this.isDevelop&&this.showPukerVertival(3),this.playedPuker=this.playerPukers3,this.playedSeat=3,this.showCount(3,this.pukers3.length),this.gameOver())return;this.playingSeat=1,this.clearPukerPlay(),this.showButtons(RoomManager.ButtonsDiscard)}},t.prototype.pukerClick=function(e){var t=RES.getRes("layout_json").puker,r=t.pukerUpMove,i=e.currentTarget,o=parseInt(i.name.split(",")[0]),n=parseInt(i.name.split(",")[1]);if(i.y==r)i.y=0,this.pukerSelectArray.push(new Poker(o,n));else{i.y=r;var s=new Poker(o,n);console.log("poker",s.toString(),"array",this.pukerSelectArray),this.pukerSelectArray=PukerUtils.removePokers(this.pukerSelectArray,[s]),console.log("removedArray",this.pukerSelectArray)}},t.prototype.createTimer=function(e,t,r,i){void 0===r&&(r=function(e){}),void 0===i&&(i=function(){});var o=new egret.Timer(e,t);o.addEventListener(egret.TimerEvent.TIMER,r,this),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,i,this),o.start()},t.prototype.clearTextTip=function(e){3===e?(null!=this.getChildByName("pukerLeft")&&this.removeChild(this.getChildByName("pukerLeft")),null!=this.getChildByName("textLeft")&&this.removeChild(this.getChildByName("textLeft"))):(null!=this.getChildByName("pukerRight")&&this.removeChild(this.getChildByName("pukerRight")),null!=this.getChildByName("textRight")&&this.removeChild(this.getChildByName("textRight")))},t.prototype.showTextTip=function(e){this.clearTextTip(e),3===e?(this.textLeft=new TextOtherContainer(PukerUtils.getRandomTextTip(),!0),this.textLeft.name="textLeft",this.addChild(this.textLeft)):(this.textRight=new TextOtherContainer(PukerUtils.getRandomTextTip(),!1),this.textRight.name="textRight",this.addChild(this.textRight))},t.prototype.clearPukerVertical=function(e){2===e?null!=this.getChildByName("pukerVerticalRight")&&this.removeChild(this.getChildByName("pukerVerticalRight")):null!=this.getChildByName("pukerVerticalLeft")&&this.removeChild(this.getChildByName("pukerVerticalLeft"))},t.prototype.showPukerVertival=function(e){this.clearPukerVertical(e),2===e?(this.pukerVerticalRight=new PukerVerticalContainer(this.pukers2,!1),this.pukerVerticalRight.name="pukerVerticalRight",this.addChild(this.pukerVerticalRight)):(this.pukerVerticalLeft=new PukerVerticalContainer(this.pukers3,!0),this.pukerVerticalLeft.name="pukerVerticalLeft",this.addChild(this.pukerVerticalLeft))},t.prototype.showOtherPortrait=function(e,t){this.clearOtherPortrait(e),3===e?(this.portraitLeft=new PortraitOtherContainer(this.player3,this.poc3Index,!0,t),this.portraitLeft.name="portraitLeft",this.addChild(this.portraitLeft)):(this.portraitRight=new PortraitOtherContainer(this.player2,this.poc2Index,!1,t),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight))},t.prototype.clearOtherPortrait=function(e){3===e?null!=this.getChildByName("portraitLeft")&&this.removeChild(this.getChildByName("portraitLeft")):null!=this.getChildByName("portraitRight")&&this.removeChild(this.getChildByName("portraitRight"))},t.prototype.clearPortrait=function(){null!=this.getChildByName("portrait")&&this.removeChild(this.getChildByName("portrait"))},t.prototype.showPortrait=function(e){this.clearPortrait(),this.portrait=new PortraitContainer(this.user,this.poc1Index,e),this.portrait.name="portrait",this.addChild(this.portrait)},t.prototype.clearCount=function(e){3===e?null!=this.getChildByName("leftCount")&&this.removeChild(this.getChildByName("leftCount")):null!=this.getChildByName("rightCount")&&this.removeChild(this.getChildByName("rightCount"))},t.prototype.showCount=function(e,t){this.clearCount(e),3===e?(this.leftCount=new OtherPukerCountContains(t,!0),this.leftCount.name="leftCount",this.addChild(this.leftCount)):(this.rightCount=new OtherPukerCountContains(t,!1),this.rightCount.name="rightCount",this.addChild(this.rightCount))},t.prototype.showOtherPuker=function(e){this.clearTextTip(e),3===e?(this.pukerLeft=new PukerOtherContainer(this.playerPukers3,!0),this.pukerLeft.name="pukerLeft",this.addChild(this.pukerLeft)):(this.pukerRight=new PukerOtherContainer(this.playerPukers2,!1),this.pukerRight.name="pukerRight",this.addChild(this.pukerRight))},t.prototype.clearButtons=function(){null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.showButtons=function(e){this.clearButtons(),this.buttons=new PlayerButtonContainer(this,e),this.buttons.name="buttons",this.addChild(this.buttons)},t.prototype.clearPukers=function(){null!=this.getChildByName("puker")&&this.removeChild(this.getChildByName("puker"))},t.prototype.showPukers=function(){this.clearPukers(),this.puker=new PukerContainer(this,this.pukers1),this.puker.name="puker",this.addChild(this.puker)},t.prototype.clearOPTimer=function(){null!=this.getChildByName("otherPlayingTimer")&&this.removeChild(this.getChildByName("otherPlayingTimer"))},t.prototype.showOPTimer=function(e){this.clearOPTimer();var t=new OtherPlayingTimer(e+"",3===this.playingSeat);t.name="otherPlayingTimer",this.addChild(t)},t}(egret.DisplayObjectContainer);__reflect(StandaloneModel.prototype,"StandaloneModel");var T_globalToLocal=function(e){function t(){function t(){var e=i.globalToLocal(0,0);o.x=e.x,o.y=e.y}var r=e.call(this)||this,i=new egret.DisplayObjectContainer;i.x=200,i.y=200,r.addChild(i);var o=new egret.Shape;return o.graphics.beginFill(16711680),o.graphics.drawCircle(25,25,25),o.graphics.endFill(),i.addChild(o),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,t,r),r}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(T_globalToLocal.prototype,"T_globalToLocal");var T_touchMove=function(e){function t(){function t(e){o=e.currentTarget,n=e.stageX-o.x,s=e.stageY-o.y,this.addChild(o),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,i,this)}function r(e){console.log(22),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i,this)}function i(e){o.x=e.stageX-n,o.y=e.stageY-s}var o,n,s,a=e.call(this)||this,h=new egret.Shape;h.graphics.beginFill(16711680),h.graphics.drawCircle(25,25,25),h.graphics.endFill(),a.addChild(h);var l=new egret.Shape;return l.graphics.beginFill(255),l.graphics.drawRect(0,0,100,100),l.graphics.endFill(),a.addChild(l),h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t,a),h.addEventListener(egret.TouchEvent.TOUCH_END,r,a),l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t,a),l.addEventListener(egret.TouchEvent.TOUCH_END,r,a),a}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(T_touchMove.prototype,"T_touchMove");var ArrayUtils=function(){function e(){}return e.removeElements=function(e,t){for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(t[r]==e[i]){e=this.slice(e,0,i).concat(this.slice(e,i+1,e.length));break}return e},e.slice=function(e,t,r){return 0>t||0>r||t>e.length||r>e.length?[]:e.slice(t,r)},e}();__reflect(ArrayUtils.prototype,"ArrayUtils");var Poker=function(){function e(e,t){this.id=e,this.orderValue=t}return e.prototype.getId=function(){return this.id},e.prototype.getOrderValue=function(){return this.orderValue},e.prototype.toString=function(){return"["+this.id+","+this.orderValue+"]"},e}();__reflect(Poker.prototype,"Poker");var PukerCompareUtils=function(){function e(){}return e.comparePukers=function(e,t){var r=PukerUtils.sortDescPokers(e),i=PukerUtils.sortDescPokers(t);if(r.length<1||i.length<1)return!1;if(-1!=PukerTypeUtils.isKingBoom(i))return!1;if(-1!=PukerTypeUtils.isKingBoom(r))return!0;if(-1!=PukerTypeUtils.isBoom(i))return-1!=PukerTypeUtils.isBoom(r)?this.compareOne(r[0],i[0]):!1;if(-1!=PukerTypeUtils.isBoom(r))return!0;if(e.length!=t.length)return!1;var o=PukerTypeUtils.getType(r),n=PukerTypeUtils.getType(i);return null==o||null==n||o.getType()!=n.getType()?!1:o.getSort()>n.getSort()},e.compareOne=function(e,t){return e.getOrderValue()>t.getOrderValue()?!0:!1},e}();__reflect(PukerCompareUtils.prototype,"PukerCompareUtils");var PukerSeekUtils=function(){function e(){}return e.seekRight=function(e,t){var r=PukerUtils.sortDescPokers(e),i=PukerUtils.sortDescPokers(t);console.log("seekRight",r,i);var o=PukerTypeUtils.getType(t),n=null;return o.getType()===PukerTypeUtils.typeKingBoom?n=null:o.getType()===PukerTypeUtils.typeSingle?n=this.seekSingle(r,o.getSort()):o.getType()===PukerTypeUtils.typePair?n=this.seekPairs(r,o.getSort()):o.getType()===PukerTypeUtils.typeThree?n=this.seekThree(r,o.getSort()):o.getType()===PukerTypeUtils.typeThreeSingle?n=this.seekThreeSingle(r,o.getSort()):o.getType()===PukerTypeUtils.typeThreePair?n=this.seekThreePair(r,o.getSort()):o.getType()===PukerTypeUtils.typeStraight?n=this.seekStraight(r,o.getSort(),i.length):o.getType()===PukerTypeUtils.typeStraightPairs?n=this.seekStraightPairs(r,o.getSort(),i.length):o.getType()===PukerTypeUtils.typePlane?n=this.seekPlane(r,o.getSort()):o.getType()===PukerTypeUtils.typePlane2Single?n=this.seekPlane2Single(r,o.getSort()):o.getType()===PukerTypeUtils.typePlane2Pairs?n=this.seekPlane2Pairs(r,o.getSort()):o.getType()===PukerTypeUtils.typeFour2Single?n=this.seekFour2Single(r,o.getSort()):o.getType()===PukerTypeUtils.typeFour2Pairs&&(n=this.seekFour2Pairs(r,o.getSort())),null!=n&&n.length>0?n:[]},e.seekBoom=function(e,t){return[]},e.seekSingle=function(e,t){for(var r=e.length-1;r>=0;r--)if(e[r].getOrderValue()>t)return[e[r]];return[]},e.seekPairs=function(e,t){for(var r=e.length-1;r>=1;r--)if(e[r].getOrderValue()===e[r-1].getOrderValue()&&e[r].getOrderValue()>t)return[e[r],e[r-1]];return[]},e.seekThree=function(e,t){for(var r=e.length-1;r>=2;r--)if(e[r].getOrderValue()===e[r-1].getOrderValue()&&e[r].getOrderValue()===e[r-2].getOrderValue()&&e[r].getOrderValue()>t)return[e[r],e[r-1],e[r-2]];return[]},e.seekThreeSingle=function(e,t){for(var r=0,i=new Array,o=e.length-1;o>=2;o--)if(e[o].getOrderValue()===e[o-1].getOrderValue()&&e[o].getOrderValue()===e[o-2].getOrderValue()&&e[o].getOrderValue()>t){r=o,i.push(e[o],e[o-1],e[o-2]);break}return 0===r?[]:(r===e.length-1?i.push(e[r-3]):i.push(e[e.length-1]),i)},e.seekThreePair=function(e,t){for(var r=0,i=new Array,o=e.length-1;o>=2;o--)if(e[o].getOrderValue()===e[o-1].getOrderValue()&&e[o].getOrderValue()===e[o-2].getOrderValue()&&e[o].getOrderValue()>t){r=o,i.push(e[o],e[o-1],e[o-2]);break}if(0!=r)for(var n=0,o=e.length-1;o>=2;o--)if(e[o].getOrderValue()===e[o-1].getOrderValue()){if(o==r||o==r-1||o==r-2)continue;n=o,i.push(e[o],e[o-1]);break}return null!=i&&5===i.length?i:[]},e.seekStraight=function(e,t,r){if(t==PukerUtils.AValue)return[];for(var i=new Array,o=null,n=e.length-1;n>=0;n--)if(e[n].getOrderValue()>t-r+1){o=e[n],i.push(e[n]);for(var s=n-1;s>=0;s--){var a=e[s].getOrderValue(),h=o.getOrderValue();if(a>PukerUtils.AValue)return[];if(r>n)return[];if(a!=h){if(a-1==h&&(o=e[s],i.push(e[s]),console.log("seekStraight",i),i.length==r))return i;if(a-1>h){i=new Array;break}}}i=new Array}return[]},e.seekStraightPairs=function(e,t,r){for(var i=new Array,o=(new Array,0);o<e.length-1;o++)e[o].getOrderValue()===e[o+1].getOrderValue()&&e[o].getOrderValue()>t-r/2&&(i.push(e[o],e[o+1]),o++);return console.log("seekStraightPairs",i),[]},e.seekPlane=function(e,t){return[]},e.seekPlane2Single=function(e,t){return[]},e.seekPlane2Pairs=function(e,t){return[]},e.seekFour2Single=function(e,t){return[]},e.seekFour2Pairs=function(e,t){return[]},e.randomPlay=function(e){return[e[e.length-1]]},e.autoPlay=function(e,t,r,i,o){return console.log("轮到我出牌了，座位号：",t,"上家出牌，座位号：",o,"地主座位号：",r),null==e||0==e.length?(console.log("没牌了"),[]):null==i||0==i.length?this.randomPlay(e):t===r?o===t?this.randomPlay(e):this.seekRight(e,i):o===t?this.randomPlay(e):o!=r?[]:this.seekRight(e,i)},e}();__reflect(PukerSeekUtils.prototype,"PukerSeekUtils");var PukerType=function(){function e(e,t){this.type=e,this.sort=t}return e.prototype.getType=function(){return this.type},e.prototype.getSort=function(){return this.sort},e}();__reflect(PukerType.prototype,"PukerType");var PukerTypeUtils=function(){function e(){}return e.getType=function(e){e=PukerUtils.sortDescPokers(e);var t=-1;return-1!=(t=this.isBoom(e))?new PukerType(this.typeBoom,t):-1!=(t=this.isKingBoom(e))?new PukerType(this.typeKingBoom,t):-1!=(t=this.isSingle(e))?new PukerType(this.typeSingle,t):-1!=(t=this.isPair(e))?new PukerType(this.typePair,t):-1!=(t=this.isThree(e))?new PukerType(this.typeThree,t):-1!=(t=this.isThreeSingle(e))?new PukerType(this.typeThreeSingle,t):-1!=(t=this.isThreePairs(e))?new PukerType(this.typeThreePair,t):-1!=(t=this.isStraight(e))?new PukerType(this.typeStraight,t):-1!=(t=this.isStraightPairs(e))?new PukerType(this.typeStraightPairs,t):-1!=(t=this.isPlane(e))?new PukerType(this.typePlane,t):-1!=(t=this.isPlane2Single(e))?new PukerType(this.typePlane2Single,t):-1!=(t=this.isPlane2pairs(e))?new PukerType(this.typePlane2Pairs,t):-1!=(t=this.isFour2Single(e))?new PukerType(this.typeFour2Single,t):-1!=(t=this.isFour2Pairs(e))?new PukerType(this.typeFour2Pairs,t):null},e.isBoom=function(e){return 4==e.length&&e[1].getOrderValue()==e[0].getOrderValue()&&e[2].getOrderValue()==e[0].getOrderValue()&&e[3].getOrderValue()==e[0].getOrderValue()?e[0].getOrderValue():-1},e.isKingBoom=function(e){return 2==e.length&&e[0].getOrderValue()===PukerUtils.BigKingValue&&e[1].getOrderValue()===PukerUtils.SmallKingValue?0:-1},e.isSingle=function(e){return 1==e.length?e[0].getOrderValue():-1},e.isPair=function(e){return 2==e.length&&e[0].getOrderValue()==e[1].getOrderValue()?e[0].getOrderValue():-1},e.isStraight=function(e){if(e.length<5||e.length>12)return-1;if(e[0].getOrderValue()>PukerUtils.AValue)return-1;for(var t=0;t<e.length-1;t++)if(e[t].getOrderValue()!=e[t+1].getOrderValue()+1)return-1;return e[0].getOrderValue()},e.isThree=function(e){return 3!=e.length?-1:e[1].getOrderValue()==e[0].getOrderValue()&&e[2].getOrderValue()==e[0].getOrderValue()?e[0].getOrderValue():-1},e.isThreeSingle=function(e){return 4!=e.length?-1:e[1].getOrderValue()===e[0].getOrderValue()&&e[2].getOrderValue()===e[0].getOrderValue()&&e[3].getOrderValue()!=e[0].getOrderValue()?e[0].getOrderValue():e[1].getOrderValue()===e[3].getOrderValue()&&e[2].getOrderValue()===e[3].getOrderValue()&&e[0].getOrderValue()!=e[3].getOrderValue()?e[1].getOrderValue():-1},e.isThreePairs=function(e){return 5!=e.length?-1:e[1].getOrderValue()===e[0].getOrderValue()&&e[2].getOrderValue()===e[0].getOrderValue()&&e[3].getOrderValue()!=e[0].getOrderValue()&&e[3].getOrderValue()===e[4].getOrderValue()?e[0].getOrderValue():e[0].getOrderValue()===e[1].getOrderValue()&&e[2].getOrderValue()===e[3].getOrderValue()&&e[3].getOrderValue()===e[4].getOrderValue()&&e[0].getOrderValue()!=e[2].getOrderValue()?e[2].getOrderValue():-1},e.isStraightPairs=function(e){if(e.length<6||e.length>20||e.length%2!=0)return-1;if(e[0].getOrderValue()<3)return-1;for(var t=0;t<e.length-1;t+=2)if(e[t].getOrderValue()!=e[t+1].getOrderValue())return-1;for(var t=0;t<e.length-2;t+=2)if(e[t].getOrderValue()!=e[t+2].getOrderValue()+1)return-1;return e[0].getOrderValue()},e.isPlane=function(e){return 6!=e.length?-1:e[0].getOrderValue()<3?-1:e[0].getOrderValue()===e[1].getOrderValue()&&e[1].getOrderValue()===e[2].getOrderValue()&&e[3].getOrderValue()===e[4].getOrderValue()&&e[4].getOrderValue()===e[5].getOrderValue()&&e[0].getOrderValue()===e[3].getOrderValue()+1?e[0].getOrderValue():-1},e.isPlane2Single=function(e){var t=[];if(8!=e.length)return-1;for(var r=0;r<e.length-2;r++)e[r].getOrderValue()===e[r+1].getOrderValue()&&e[r].getOrderValue()==e[r+2].getOrderValue()&&t.push(e[r]);return 2!=t.length?-1:t[0].getOrderValue()>PukerUtils.AValue?-1:t[0].getOrderValue()-1===t[1].getOrderValue()?t[0].getOrderValue():-1},e.isPlane2pairs=function(e){if(10!=e.length)return-1;for(var t=[],r=[],i=0;i<e.length-2;i++)e[i].getOrderValue()==e[i+1].getOrderValue()&&e[i].getOrderValue()==e[i+2].getOrderValue()&&r.push(e[i]),t=t.concat(PukerUtils.removePokers(e,[e[i],e[i+1],e[i+2]]));
if(2!=r.length)return-1;t=PukerUtils.removePokers(e,t);for(var i=0;i<t.length-1;i+=2)if(t[i].getOrderValue()!==t[i+1].getOrderValue())return-1;return r[0].getOrderValue()>PukerUtils.AValue?-1:r[0].getOrderValue()-1===r[1].getOrderValue()?r[0].getOrderValue():-1},e.isFour2Single=function(e){if(6!=e.length)return-1;for(var t=0;t<e.length-3;t++)if(e[t].getOrderValue()===e[t+1].getOrderValue()&&e[t].getOrderValue()===e[t+2].getOrderValue()&&e[t].getOrderValue()===e[t+3].getOrderValue())return e[t].getOrderValue();return-1},e.isFour2Pairs=function(e){var t,r=[];if(8!=e.length)return-1;for(var i=0;i<e.length-3;i++)e[i].getOrderValue()===e[i+1].getOrderValue()&&e[i].getOrderValue()===e[i+2].getOrderValue()&&e[i].getOrderValue()===e[i+3].getOrderValue()&&(r=r.concat(PukerUtils.removePokers(e,[e[i],e[i+1],e[i+2],e[i+3]])),t=e[i]);for(var i=0;i<r.length-1;i+=2)if(r[i].getOrderValue()!==r[i+1].getOrderValue())return-1;return t.getOrderValue()},e.typeBoom="typeBoom",e.typeKingBoom="typeKingBoom",e.typeSingle="typeSingle",e.typePair="typePair",e.typeThree="typeThree",e.typeThreeSingle="typeThreeSingle",e.typeThreePair="typeThreePair",e.typeStraight="typeStraight",e.typeStraightPairs="typeStraightPairs",e.typePlane="typePlane",e.typePlane2Single="typePlane2Single",e.typePlane2Pairs="typePlane2Pairs",e.typeFour2Single="typeFour2Single",e.typeFour2Pairs="typeFour2Pairs",e}();__reflect(PukerTypeUtils.prototype,"PukerTypeUtils");var PukerUtils=function(){function e(){}return e.getRandomPokers=function(){for(var e,t,r=new Array,i=this.pukerIds.length,o=this.pukerIds.slice(),n=[],s=0;s<this.pukerIds.length;s++)e=Math.floor(Math.random()*o.length),t=o[e],n.push(t),o=ArrayUtils.slice(o,0,e).concat(ArrayUtils.slice(o,e+1,o.length)),i--;for(var a=0;a<n.length;a++){var h=new Poker(this.pukerIds[n[a]-1],this.pukerSortValues[n[a]-1]);r.push(h)}return console.log("已随机生成一副牌",r.toString()),r},e.sortDescPokers=function(e){return e.sort(this.sortDesc)},e.removePokers=function(e,t){for(var r=new Array,i=0;i<e.length;i++){for(var o=!1,n=0;n<t.length;n++)e[i].getId()==t[n].getId()&&(o=!0);o||r.push(e[i])}return r},e.sortDesc=function(e,t){return e.getOrderValue()<t.getOrderValue()?1:e.getOrderValue()>t.getOrderValue()?-1:0},e.getRandomUser=function(){var e=this.randomUsers[Math.floor(Math.random()*this.randomUsers.length)];return new User(e.name,e.sex)},e.getRandomTextTip=function(){return this.textTip[Math.floor(Math.random()*this.textTip.length)]},e.pukerSortValues=[12,12,12,12,13,13,13,13,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,14,15],e.AValue=12,e.BigKingValue=15,e.SmallKingValue=14,e.pukerIds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],e.randomUsers=[{uid:"1001",name:"大可",sex:"man"},{uid:"1002",name:"Tiger",sex:"lady"},{uid:"1003",name:"翔",sex:"man"},{uid:"1004",name:"傻源源",sex:"man"},{uid:"1005",name:"傻乐乐",sex:"man"},{uid:"1006",name:"小巴西",sex:"lady"},{uid:"1007",name:"油烟机",sex:"man"},{uid:"1008",name:"可乐鸡翅",sex:"lady"},{uid:"1009",name:"酸辣土豆丝",sex:"lady"},{uid:"1010",name:"糖拌西红柿",sex:"man"},{uid:"1011",name:"拍黄瓜",sex:"man"},{uid:"1012",name:"空调没有遥控器",sex:"man"},{uid:"1013",name:"这么晚了还不回家",sex:"lady"},{uid:"1014",name:"程咬金",sex:"man"},{uid:"1015",name:"猫砂不会盖",sex:"man"},{uid:"1016",name:"风扇不摇头",sex:"man"},{uid:"1017",name:"油炸花生米",sex:"man"},{uid:"1018",name:"电视不能看",sex:"man"},{uid:"1019",name:"绿萝",sex:"lady"},{uid:"1020",name:"薄荷糖不麻",sex:"lady"},{uid:"1021",name:"翔的小姐姐",sex:"lady"},{uid:"1022",name:"孤单想吃西瓜",sex:"man"},{uid:"1023",name:"一个人看烟花",sex:"lady"},{uid:"1024",name:"大海啊你全是水",sex:"man"},{uid:"1025",name:"骏马啊你四条腿",sex:"man"}],e.textTip=["不要","没你的大","要不起","你厉害","我认怂","你牛","过","GO","PASS","0.0"],e}();__reflect(PukerUtils.prototype,"PukerUtils");var Room=function(){function e(){}return e}();__reflect(Room.prototype,"Room");var RoomManager=function(){function e(){}return e.Request_onRoom=1001,e.Request_BeReady=1002,e.Request_CallTheLandlord=1003,e.Request_Discard=1004,e.Response_InitUserOK=2e3,e.Response_RoomInfo=2001,e.Response_NewPlayerJoin=20011,e.Response_Reday=2002,e.Response_DealPoker=2003,e.Response_ToCallTheLandlord=2005,e.Response_LandlordAndLastCard=2006,e.Response_Discard=2007,e.Response_GameOver=2008,e.Victory_Landlord="Landlord",e.Victory_Farmer="Farmer",e.ButtonsCallTheLandlord=0,e.ButtonsFight4TheLandlord=1,e.ButtonsDiscard=2,e.ButtonsGameOver=3,e}();__reflect(RoomManager.prototype,"RoomManager");var User=function(){function e(e,t){this.seat=1,this.isLandlord=!1,this.name=e,this.sex=t}return e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getSex=function(){return this.sex},e.prototype.getSeat=function(){return this.seat},e.prototype.getILandlord=function(){return this.isLandlord},e.prototype.setSeat=function(e){this.seat=e},e.prototype.setId=function(e){this.id=e},e.prototype.setName=function(e){this.name=e},e.prototype.setLandlord=function(e){this.isLandlord=e},e}();__reflect(User.prototype,"User");